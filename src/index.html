<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mosyre IDE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="content/css/main.css" />

    <script src="content/d3/d3.min.js"></script>
    <script src="content/mosyrejs2/mosyrejs2.min.js"></script>
</head>
<body>
    <svg id="main-canvas">
        <g id="move">
            <rect x="0" y="0" width="100" height="100" stroke="white"/>
        </g>
    </svg>

    <script>
        let canvas = document.getElementById("main-canvas")
        let x,y,zoom=8;
        let px = 0,py = 0;
        let transform = ["",""];
        d3.select(canvas).on("wheel",function(e = d3.event){
            if(e.deltaY < 0){
                zoom+=.1;
            }
            else zoom-=.1;
            zoom = Math.max(0,zoom)
            transform[0] = `scale(${zoom})`
            mov.attr("transform",transform.join(" "))
        })

        d3.select(canvas).on("mousedown",function(e = d3.event){            
            x = e.clientX;
            y = e.clientY;
        })
        let mov = d3.select("#move")
        d3.select(canvas).on("mousemove",function(e = d3.event){            
            if(e.buttons === 1){
                let dx =x - e.clientX;
                let dy =y - e.clientY;
                px+=dx/zoom;
                py+=dy/zoom;
                x=e.clientX;
                y=e.clientY;
                transform[1] = `translate(${-px},${-py})`
                mov.attr("transform", transform.join(" "))

            }
            
        })
        
    </script>
</body>
</html>